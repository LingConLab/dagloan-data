---
title: "Quantifying lexical contact in Daghestan"
author: "M. Daniel, I. Chechuro, S. Verhees"
date: "20.02.2018 <br> Linguistic Convergence Lab Seminar"
output:
  xaringan::moon_reader:
    css: ["default", "my_theme.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = FALSE,
                      message=FALSE,
                      warning= FALSE,
                      fig.width=10.4,
                      fig.height=7)
library(tidyverse)
library(lingtypology)
library(phangorn)
library(knitr)
```

## Shortlist

- [WOLD](http://wold.clld.org/meaning) questionniare - 1814 items 

--

- Gathered in all major languages from dictionaries: Avar, Standard Dargwa, Lezgian, Lak, Chechen, *Kumyk, Azeri*

--

- Selection of concepts with assumedly high borrowability - ~225 items

--

- Comparison of Archi (Lezgic) and Bezhta (Tsezic) from WOLD. *(Not all items from our shortlist are represented in this data.)*

---

## Shortlist versus WOLD longlist

```{r, echo = F, results = 'asis'}

count <- read_tsv("loancount.csv")
colnames(count) <- c("Archi", "long", "%", "short", "%",
                     "Bezhta", "long", "%", "short", "%")

kable(count[,1:5], format = "html")


```

Similar percentages for most values, 
*but* a relatively large amount of **non loans**.

---

## Shortlist versus WOLD longlist

```{r, echo = F, results = 'asis'}

count <- read_tsv("loancount.csv")
colnames(count) <- c("Archi", "long", "%", "short", "%",
                     "Bezhta", "long", "%", "short", "%")

kable(count[,6:10], format = "html")


```

Percentage of Georgian borrowings rises relatively, while Avar drops.

---

## Shortlist versus WOLD longlist

- The shortlist captures similar percentages to the long list

--

- For Archi, they concur with data on multilingualism (many people speak Avar, some speak Lak)

--

- But also many non loans

--

- Relative rise of Georgian borrowings in Bezhta is due to everyday objects (e.g. 'spoon', 'candle')

--

- Drop in percentage of Avar loans is due to abstract concepts and adjectives


---


class: inverse, center, middle

## Fieldwork

```{r, fig.height=7}

# general area map

loan <- read_csv("loan_villages.csv")

map.feature(loan$Language,
            features = loan$Language,
            tile = c("Esri.OceanBasemap"),
            color = loan$color,
            latitude = loan$Lat,
            longitude = loan$Lon,
            title = "Language",
            label = loan$EngNames,
            label.hide = F,
            zoom.control = T)

```

---

## From similarity sets to distance matrix

- Lexemes from different lects are grouped into similarity sets
Each set is coded with a number. One language may use several lexical items and thus be ascribed several similarity sets.
Count similarities between lects by counting how many similarity sets two lects share. (SV-style below)

--

```{r}

sim <- read_tsv("similarity.csv")
kable(sim, format = "html")

```

--

- We want to assess proximity by contact not by origin. Similarity by cognates does not count. 
Similarity sets are only counted if it goes beyond a set of closely related languages.
Lines where similarity sets are contained in e.g. Turkic only or Rutul only are excluded from the counts. (MD-style below)

--

- Number of times two languages share a similarity set is converted into a distance matrix

---


## Similarity to distance matrix

- The number of times two languages share a similarity set is converted into a distance matrix 
The number of shared sets divided by the number of meanings (minus the meanings for which one of the lects had not data)

--
```{r}

dist <- read.csv("rutul_dist.csv", sep = ";")
kable(dist[1:4,1:3], format = "html")

```

--

- Distance matrix forms the input for a neighbournet visualization

---

## Rutul area

```{r}

Rutul_dist <- read.csv("rutul_dist.csv", header = TRUE, sep = ";", na.strings = "NA")
View(Rutul_dist)
Rutul_dist <- as.dist(Rutul_dist)
nnet <- neighborNet(Rutul_dist)
plot(nnet, "2D")

```
---

## Distance between major languages

```{r}

Big_dist <- read.csv("Big_dist.csv", header = TRUE, sep = ";", na.strings = "NA")
View(Big_dist)
Big_dist <- as.dist(Big_dist)
nnet <- neighborNet(Big_dist)
plot(nnet, "2D")

```

---



## Avar area


---

## Problems


---

## Further plans



